;-----------------------------------------------------------------------
; 名前：Benizara / 紅皿 ver.0.1.1
; キーボード配列エミュレーションソフトウェア
; 作者：綾木　健一郎
; 平成30年10月7日
;-----------------------------------------------------------------------
１．	始めに
１．１．何をするものなのか
　Benizaraは、Windows環境に接続されたJISキーボードで親指シフト (NICOLA配列) による入力を可能にするエミュレーションソフトウェアです。Windows7のMS-IMEとATOK2011、およびWindows10のMS-IMEで動作を確認しています。なお、Benizaraは、設定ファイルを読み込ませることにより、親指シフトに限らず、任意にキーボード配列のエミュレーションが可能です。
　Benizara（紅皿）の名前は、太田道灌の山吹伝説に由来します。

１．２．特徴
・Windows10のストアアプリや、Microsoft Edge上でも親指シフト入力が可能です。
・やまぶきと同様に１２面のシフトモードを実現し、やまぶきの配列定義ファイルをある程度まで読込可能としました。
・やまぶきの打鍵ロジックを参考に実装し、かつ連続シフトモードをサポートしています。よって、やまぶき（やまぶきＲ）からの移行は容易とおもいます。
・Benizaraは、AutoHotKeyのスクリプトを実行ファイル化したものです。ユーザモードでキーフックするタイプのエミュレータなので、導入も停止も簡単です。USBメモリで持ち歩くこともできます。
・親指の友Mk-2 キーボードドライバ V2.0L23に実装された「零遅延モード」を、当該ソフトにも実装しました。零遅延モードとは、親指シフト時の表示遅延をゼロにして、高速打鍵を可能とするモードです。
１．３．未だ実装していないこと
・機能キーの切り替え、単独打鍵の有効・無効の切り替え、キーリピートの有無の切り替えは未だ実装していません。
１．４．入力速度ベンチマーク
・落語「じゅげむ」の名前を入力するベンチマークで評価しました。具体的にいうと「じゅげむじゅげむごこうのすりきれ　かいじゃりすいぎょのすいぎょうまつうんらいまつふうらいまつ　くうねるところにすむところ　やぶらこうじのぶらこうじ　ぱいぽぱいぽぱいぽのしゅーりんがん　しゅーりんがんのぐーりんたい　ぐーりんたいのぽんぽこぴーのぽんぽこなーのちょうきゅうめいのちょうすけ」を仮名入力する時間を計測するものです。このベンチマークは、今井士郎さんのブログを参考にしました。
・自分が「じゅげむベンチマーク」を実行した際の親指シフト入力の最速は４５秒、平均は５５秒でした。なお、ローマ字入力の最速は７５秒、平均は８０秒でした。

２．	使い方
２．１．取り扱い種別
　Benizara（紅皿）はフリーソフトウエアであり、IME.ahk, Path.ahkを除く各ソースコードはMITライセンスの下で再利用可能です
　なお、Benizaraのソースコードのうち、IME.ahk, Path.ahk は、eamatさまが作成されたライブラリです。

２．２．動作環境
　Windows7とWindows10で動作確認していますが、NT系のWindowsならば、どの環境でも動作する筈です。
　IMEは、Atok11とMS-IMEで動作確認しています。
２．３．インストール方法
（１）インストーラ版では、Benizara_0111.zipを所望のパスに解凍して、setup.exe を実行してください。お使いのJIS109キーボードが親指シフト (NICOLA配列) に切り替わります。
（２）実行ファイル版では、BenizaraEXE_011a.zipを所望のパスに解凍してください。benizara.exe を実行すると、お使いのJIS109キーボードが親指シフト (NICOLA配列) に切り替わります。


３．	紅皿設定の説明
タスクトレイの紅皿アイコンを右クリックして、紅皿設定をクリックすると以下の設定ダイアログが表示されます。各タブの下のOKボタンをクリックすると変更が反映され、キャンセルボタンをクリックすると変更が破棄されます。

３．１．配列タブ
配列定義ファイルを表示し、かつ切り替える機能を備えたタブです。
その下側には、配列のモードと、そのときのモード名とキー配列が表示されています。
 
「…」ボタンをクリックすると、ファイル選択ダイアログが開き、配列定義ファイルを選択可能となります。
配列のモードのコンボボックスを選択することで、キー配列の表示が選択したモードに切り替わります。
?
３．２．親指シフトタブ
親指シフトに関する設定画面です。
・親指シフトキーのコンボボックスは、変換−無変換と無変換−空白が選択可能です。
　無変換−変換を選択した場合、無変換キーが左親指キー、変換キーが右親指キーです。
　無変換−空白を選択した場合、無変換キーが左親指キー、空白キーが右親指キーです。
・連続シフトのチェックポックスは、親指シフトキーの押下中に、連続してシフトモードの文字を入力するためのものです。推奨設定はオンです。
・零遅延モードのチェックポックスは、キー押下と共に遅延無く文字を出力する「零遅延モード」をオンするものであり、推奨設定はオンです。この零遅延モードは、親指の友Mk-2キーボードドライバ（聖人さま作）の機能を参考としました。
・単独打鍵は、ver0.1.0では無効に固定です。将来の拡張のために表示されています。
・キーリピートのチェックボックスは、無効に固定です。将来の拡張のために表示されています。
・文字と親指シフトの同時打鍵の割合は、20〜80[%]の間で可変です。親指シフトキーの押下に対して文字キーの押下が重なったとき、この割合を満たしたならば同時打鍵となります。推奨値は40〜60%です。
・文字と親指シフトの同時打鍵の判定時間は、10〜400[mSEC]の間で可変です。NICOLA規格では、50〜200[mSEC]が推奨されています。
推奨値は、連続シフトの場合で50[mSEC]、連続シフトしない場合で150[mSEC]です。
 

３．３．紅皿についてタブ
バージョン情報や紅皿の概要が書かれたタブです。
?
４．	キー配列（デフォルト）
　紅皿は、やまぶきと同様に、ローマ字モード６面と、英数モード６面の全１２面のキーボードレイアウトを持っています。ローマ字モードは、ＩＭＥをローマ字入力のひらがな・全角カタカナ・半角カタカナに設定したときのモードであり、英数モードは、ＩＭＥを全角英数・半角英数・直接入力に設定したときのモードです。以下表に、各レイアウト名とシフト操作との関係を示します。

レイアウト名　　　　　　｜	シフト操作
−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−
ローマ字シフト無し　　　｜	シフト無し
ローマ字右親指シフト　　｜	右親指キーと共に文字キー打鍵
ローマ字左親指シフト　　｜	左親指キーと共に文字キー打鍵
ローマ字小指シフト　　　｜	小指シフト
ローマ字小指右親指シフト｜	小指シフトした状態で、右親指キーと共に文字キー打鍵
ローマ字小指左親指シフト｜	小指シフトした状態で、右親指キーと共に文字キー打鍵
英数シフト無し　　　　　｜	シフト無し
英数右親指シフト　　　　｜	右親指キーと共に文字キー打鍵
英数左親指シフト　　　　｜	左親指キーと共に文字キー打鍵
英数小指シフト　　　　　｜	小指シフト
英数小指右親指シフト　　｜	小指シフトした状態で、右親指キーと共に文字キー打鍵
英数小指左親指シフト　　｜	小指シフトした状態で、右親指キーと共に文字キー打鍵

　　上記のレイアウトは、紅皿が読み込むキー配列ファイルによって変更することができます。

５．	アンインストール方法
５．１．インストーラ版
タスクトレイの紅皿アイコンを右クリックして、Exitをクリックしてbenizaraを停止させます。そして、コントロールパネルの「プログラムのアンインストール」を選択し、Benizaraを削除してください。
５．２．実行ファイル版
タスクトレイの紅皿アイコンを右クリックして、Exitをクリックしてbenizaraを停止させます。そして、Benizara.exeが格納されたフォルダを削除してください。

６．	作者への連絡方法
Linkedin：https://www.linkedin.com/in/ken-ichiro-ayaki-965b2a8a/
Mail: kenichiro_ayaki@users.osdn.me

７．	配布ファイルとその構成
Benizara.exe・・・ 紅皿の実行ファイルです。
Benizara.ini・・・紅皿の設定情報ファイルです。
NICOLA配列.bnz・・・NICOLA配列のファイルです。
Dvorak配列.bnz・・・Dvorak配列のファイルです。
NICOLA配列_仮名直接入力.bnz・・・タイプウェルで仮名文字を入力する際の配列です。

以上
